# Family structure by country
ta_struct_ctry <-
family %>%
group_by(country) %>%
count(structure) %>%
mutate(prop_struct_ctry = n / sum(n))
ta_struct_ctry
#ta_struct_ctry
file <- tempfile(fileext = ".png")
png(file, width = 600, height = 400)
set.seed(1)
ggplot(data = ta_struct_ctry, aes(x = country, y = prop_struct_ctry, fill = structure)) +
geom_bar(position = "fill", stat = "identity") +
#scale_fill_discrete("Structure",labels=c('Low','Step fathers','Single mother')) +
scale_fill_brewer(palette="PRGn")+
coord_flip() +
scale_y_continuous(labels = percent_format()) +
#scale_y_reverse()+
theme(plot.subtitle = element_text(vjust = 1),
plot.caption = element_text(vjust = 1),
legend.title = element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
legend.position = "bottom", legend.direction = "horizontal")
ggplot(data = ta_struct_ctry, aes(x = country, y = prop_struct_ctry, fill = structure)) +
geom_bar(position = "fill", stat = "identity") +
#scale_fill_discrete("Structure",labels=c('Low','Step fathers','Single mother')) +
scale_fill_brewer(palette="PRGn")+
coord_flip() +
scale_y_continuous(labels = percent_format()) +
#scale_y_reverse()+
theme(plot.subtitle = element_text(vjust = 1),
plot.caption = element_text(vjust = 1),
legend.title = element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
legend.position = "bottom", legend.direction = "horizontal")
ta_struct_ctry_age <-
family %>%
group_by(country, childgpage) %>%
count(structure) %>%
mutate(prop_struct_ctry_age = n / sum(n))
ta_struct_ctry_age
ta_struct_ctry_age %>%
ggplot(aes(x = country, y = prop_struct_ctry_age, fill = structure)) +
geom_bar(position = "fill", stat = "identity") +
scale_fill_brewer(palette="PRGn")+
coord_flip() +
facet_wrap(~ childgpage, nrow = 1) +
#facet_grid(. ~ childgpage) +
scale_y_continuous(labels = percent_format()) +
theme(plot.subtitle = element_text(vjust = 1),
plot.caption = element_text(vjust = 1),
legend.title = element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
legend.position = "bottom", legend.direction = "horizontal")
ta_struct_ctry_age %>%
ggplot(aes(x = country, y = prop_struct_ctry_age, fill = structure)) +
geom_bar(alpha = 4/5, position = "fill", stat = "identity") +
scale_fill_brewer(palette="PRGn")+
coord_flip() +
#facet_wrap(~ childgpage, nrow = 3) +
facet_grid(. ~ childgpage) +
scale_y_continuous(labels = percent_format()) +
theme(plot.subtitle = element_text(vjust = 1),
plot.caption = element_text(vjust = 1),
legend.title = element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
legend.position = "bottom", legend.direction = "horizontal")
struc_ssa_tidy <-
struc_ssa %>%
select(childgpage, `structureBoth parents`:`structureFostered out`) %>%
gather(key = "structure", value = "proportion", `structureBoth parents`:`structureFostered out`) %>%
separate(structure, c("struct_label", "structure"), sep = "structure")
# The design used in this study, similar to venderelst.
dhs.design4 <- svydesign(id = ~ hv001 + hv002, strata = ~hv025, weights = ~ wgt, data = family, nest = TRUE)
ta_struct_ctry
ta_struct_ctry
ggplot(data = ta_struct_ctry, aes(x = country, y = prop_struct_ctry, fill = structure)) +
geom_bar(position = "fill", stat = "identity") +
#scale_fill_discrete("Structure",labels=c('Low','Step fathers','Single mother')) +
scale_fill_brewer(palette="PRGn")+
coord_flip() +
scale_y_continuous(labels = percent_format()) +
#scale_y_reverse()+
theme(plot.subtitle = element_text(vjust = 1),
plot.caption = element_text(vjust = 1),
legend.title = element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
legend.position = "bottom", legend.direction = "horizontal")
ggplot(data = ta_struct_ctry, aes(x = as.factor(country), y = prop_struct_ctry, fill = as,factor(structure)) +
ggplot(data = ta_struct_ctry, aes(x = as.factor(country), y = prop_struct_ctry, fill = as,factor(structure))) +
geom_bar(position = "fill", stat = "identity") +
#scale_fill_discrete("Structure",labels=c('Low','Step fathers','Single mother')) +
scale_fill_brewer(palette="PRGn")+
coord_flip() +
scale_y_continuous(labels = percent_format()) +
#scale_y_reverse()+
theme(plot.subtitle = element_text(vjust = 1),
plot.caption = element_text(vjust = 1),
legend.title = element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
legend.position = "bottom", legend.direction = "horizontal")
ggplot(data = ta_struct_ctry, aes(x = as.factor(country), y = prop_struct_ctry, fill = as,factor(structure))) +
ggplot(data = ta_struct_ctry, aes(x = as.factor(country), y = prop_struct_ctry, fill = as,factor(structure))) +
geom_bar(position = "fill", stat = "identity") +
#scale_fill_discrete("Structure",labels=c('Low','Step fathers','Single mother')) +
scale_fill_brewer(palette="PRGn")+
coord_flip() +
scale_y_continuous(labels = percent_format()) +
#scale_y_reverse()+
theme(plot.subtitle = element_text(vjust = 1),
plot.caption = element_text(vjust = 1),
legend.title = element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
legend.position = "bottom", legend.direction = "horizontal")
ggplot(data = ta_struct_ctry, aes(x = as.factor(country), y = prop_struct_ctry, fill = as.factor(structure))) +
geom_bar(position = "fill", stat = "identity") +
#scale_fill_discrete("Structure",labels=c('Low','Step fathers','Single mother')) +
scale_fill_brewer(palette="PRGn")+
coord_flip() +
scale_y_continuous(labels = percent_format()) +
#scale_y_reverse()+
theme(plot.subtitle = element_text(vjust = 1),
plot.caption = element_text(vjust = 1),
legend.title = element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
legend.position = "bottom", legend.direction = "horizontal")
ggplot(data = ta_struct_ctry, aes(x = as.factor(country), y = prop_struct_ctry, fill = structure)) +
geom_bar(position = "fill", stat = "identity") +
#scale_fill_discrete("Structure",labels=c('Low','Step fathers','Single mother')) +
scale_fill_brewer(palette="PRGn")+
coord_flip() +
scale_y_continuous(labels = percent_format()) +
#scale_y_reverse()+
theme(plot.subtitle = element_text(vjust = 1),
plot.caption = element_text(vjust = 1),
legend.title = element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
legend.position = "bottom", legend.direction = "horizontal")
labeled_vars <- sapply(master_family, function(x) class(x) == "labelled")
master_family[, labeled_vars] <- lapply(master_family[, labeled_vars], as_factor)
head(master_family)
ggplot(data = ta_struct_ctry, aes(x = as.factor(country), y = prop_struct_ctry, fill = as.factor(structure))) +
geom_bar(position = "fill", stat = "identity") +
#scale_fill_discrete("Structure",labels=c('Low','Step fathers','Single mother')) +
scale_fill_brewer(palette="PRGn")+
coord_flip() +
scale_y_continuous(labels = percent_format()) +
#scale_y_reverse()+
theme(plot.subtitle = element_text(vjust = 1),
plot.caption = element_text(vjust = 1),
legend.title = element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
legend.position = "bottom", legend.direction = "horizontal")
file <- tempfile(fileext = ".png")
png(file, width = 600, height = 400)
set.seed(1)
ggplot(data = ta_struct_ctry, aes(x = as.factor(country), y = prop_struct_ctry, fill = as.factor(structure))) +
geom_bar(position = "fill", stat = "identity") +
#scale_fill_discrete("Structure",labels=c('Low','Step fathers','Single mother')) +
scale_fill_brewer(palette="PRGn")+
coord_flip() +
scale_y_continuous(labels = percent_format()) +
#scale_y_reverse()+
theme(plot.subtitle = element_text(vjust = 1),
plot.caption = element_text(vjust = 1),
legend.title = element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
legend.position = "bottom", legend.direction = "horizontal")
dev.off()
png
magick::image_read(file)
install.packages("magick")
library(magick)
magick::image_read(file)
png
magick::image_read(file)
ta_struct_ctry_age %>%
ggplot(aes(x = country, y = prop_struct_ctry_age, fill = structure)) +
geom_bar(alpha = 4/5, position = "fill", stat = "identity") +
scale_fill_brewer(palette="PRGn")+
coord_flip() +
#facet_wrap(~ childgpage, nrow = 3) +
facet_grid(. ~ childgpage) +
scale_y_continuous(labels = percent_format()) +
theme(plot.subtitle = element_text(vjust = 1),
plot.caption = element_text(vjust = 1),
legend.title = element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
legend.position = "bottom", legend.direction = "horizontal")
ggplot(data = struc_ssa_tidy, aes(x = childgpage, y = proportion1, fill = structure, label = proportion1)) +
geom_bar(stat = "identity", position = position_stack(reverse = TRUE)) +  # change the order of the modalities
geom_text(aes(x = childgpage, y = proportion1, label = round(proportion1, 2)),size = 3, position =        position_stack(reverse = TRUE, vjust = 0.5), color = "white") +
scale_fill_brewer(palette="PRGn")+
#coord_flip() +
scale_x_discrete(limits = c("0 - 4", "5 - 9", "10 - 14", "Total")) +
# scale_y_continuous(labels = percent_format()) + when use proportion
scale_y_continuous() +
theme(plot.subtitle = element_text(vjust = 1),
plot.caption = element_text(vjust = 1),
legend.title = element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
legend.position = "bottom", legend.direction = "horizontal")
struc_ssa_tidy <-
struc_ssa %>%
select(childgpage, `structureBoth parents`:`structureFostered out`) %>%
gather(key = "structure", value = "proportion", `structureBoth parents`:`structureFostered out`) %>%
separate(structure, c("struct_label", "structure"), sep = "structure")
struc_ssa <- svyby(~structure, ~childgpage, dhs.design5, svymean)#, keep.names = FALSE, verbose = FALSE)
struc_ctry <- svyby(~structure, ~country, dhs.design4, svymean)#, keep.names = FALSE, verbose = FALSE)
struc_ctry
struc_ctry_tidy <-
struc_ctry %>%
select(country, `structureBoth parents`:`structureFostered out`) %>%
gather(key = "structure", value = "proportion", `structureBoth parents`:`structureFostered out`) %>%
separate(structure, c("struct_label", "structure"), sep = "structure")
struc_ctry
struc_ctry
ta_struct_ctry_age <-
family %>%
group_by(country, childgpage) %>%
count(structure) %>%
mutate(prop_struct_ctry_age = n / sum(n))
ta_struct_ctry_age
ta_struct_ctry_age %>%
ggplot(aes(x = country, y = prop_struct_ctry_age, fill = structure)) +
geom_bar(position = "fill", stat = "identity") +
scale_fill_brewer(palette="PRGn")+
coord_flip() +
facet_wrap(~ childgpage, nrow = 1) +
#facet_grid(. ~ childgpage) +
scale_y_continuous(labels = percent_format()) +
theme(plot.subtitle = element_text(vjust = 1),
plot.caption = element_text(vjust = 1),
legend.title = element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
legend.position = "bottom", legend.direction = "horizontal")
ta_struct_ctry_age %>%
ggplot(aes(x = country, y = prop_struct_ctry_age, fill = as.factor(structure))) +
geom_bar(position = "fill", stat = "identity") +
scale_fill_brewer(palette="PRGn")+
coord_flip() +
facet_wrap(~ childgpage, nrow = 1) +
#facet_grid(. ~ childgpage) +
scale_y_continuous(labels = percent_format()) +
theme(plot.subtitle = element_text(vjust = 1),
plot.caption = element_text(vjust = 1),
legend.title = element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
legend.position = "bottom", legend.direction = "horizontal")
ggsave(graph1.jpeg)
ggsave("graph1.jpeg")
labeled_vars <- sapply(master_family, function(x) class(x) == "labelled")
master_family[, labeled_vars] <- lapply(master_family[, labeled_vars], as_factor)
data(mtcars)
m1 <- glmer(mtcars$am ~ 1 + mtcars$wt + (1|mtcars$gear), family="binomial")
library(lme4)
data(mtcars)
m1 <- glmer(mtcars$am ~ 1 + mtcars$wt + (1|mtcars$gear), family="binomial")
m2 <- glmer(am ~ 1 + wt + (1|gear), family="binomial", data=mtcars)
p1 <- predict(m1); p2 <- predict(m2)
names(p1) # not that informative...
names(p2) # very informative!
p2
p1
as_factor(master_family)
View(master_family)
head(master_family)
rm(list = ls())
# Download previous version of a package
#library(devtools)
#install_version("haven", version = "1.1.2")
getwd()
setwd("/Users/visseho/Documents/Documents - MacBook Pro/RESEARCH/Data/Family_Africa/")
library(tidyverse)
library(rio)
library(ggpubr)         # help to combine figure
library(haven)
library(broom)
library(readstata13)
library(stargazer)
library(summarytools)
library(scales)
library(srvyr)
library(survey)
library(plotrix)
library(foreign)
library(magick)
library(sjlabelled)   # Convert variable into factor with associated value labels
#library(ddply)
#master_family <- read_dta("master_family.dta")
master_family <- read_dta("master_family_w.dta")   # this master data with _w contains the pooling weight newwgt
labeled_vars <- sapply(master_family, function(x) class(x) == "labelled")
master_family[, labeled_vars] <- lapply(master_family[, labeled_vars], as_factor)
#labeled_vars
#library(dplyr)
#makeVlist <- function(dta) {
#     labels <- sapply(dta, function(x) attr(x, "label"))
#      tibble(name = names(labels),
#             label = labels)
#}
#makeVlist(master_family)
d
table(master_family$structure)
table(master_family$structure)
rm(list = ls())
getwd()
setwd("/Users/visseho/Documents/Documents - MacBook Pro/RESEARCH/Data/Family_Africa/")
library(tidyverse)
library(rio)
library(ggpubr)         # help to combine figure
library(haven)
library(broom)
library(readstata13)
library(stargazer)
library(summarytools)
library(scales)
library(srvyr)
library(survey)
library(plotrix)
library(foreign)
library(magick)
#library(ddply)
#master_family <- read_dta("master_family.dta")
master_family <- read_dta("master_family_w.dta")   # this master data with _w contains the pooling weight newwgt
as_factor(master_family)
labeled_vars <- sapply(master_family, function(x) class(x) == "labelled")
master_family[, labeled_vars] <- lapply(master_family[, labeled_vars], as_factor)
#library(dplyr)
#makeVlist <- function(dta) {
#     labels <- sapply(dta, function(x) attr(x, "label"))
#      tibble(name = names(labels),
#             label = labels)
#}
#makeVlist(master_family)
head(master_family)
glimpse(master_family)
table(master_family$structure)
rm(list = ls())
getwd()
setwd("/Users/visseho/Documents/Documents - MacBook Pro/RESEARCH/Data/Family_Africa/")
library(tidyverse)
library(rio)
library(ggpubr)         # help to combine figure
library(haven)
library(broom)
library(readstata13)
library(stargazer)
library(summarytools)
library(scales)
library(srvyr)
library(survey)
library(plotrix)
library(foreign)
library(magick)
#library(ddply)
#master_family <- read_dta("master_family.dta")
master_family <- read_dta("master_family_w.dta")   # this master data with _w contains the pooling weight newwgt
#as_factor(master_family)
labeled_vars <- sapply(master_family, function(x) class(x) == "labelled")
master_family[, labeled_vars] <- lapply(master_family[, labeled_vars], as_factor)
#library(dplyr)
#makeVlist <- function(dta) {
#     labels <- sapply(dta, function(x) attr(x, "label"))
#      tibble(name = names(labels),
#             label = labels)
#}
#makeVlist(master_family)
head(master_family)
glimpse(master_family)
table(master_family$structure)
table(master_family$structure)
packageVersion("haven")
devtools::install_github("marcusvolz/mathart")
devtools::install_github("marcusvolz/ggart")
library(mathart)
df <- rbind(heart1() %>% mutate(id = 1),
heart2() %>% mutate(id = 2),
heart3() %>% mutate(id = 3),
heart4() %>% mutate(id = 4))
df <- rbind(butterfly1() %>% mutate(id = 1),
butterfly2() %>% mutate(id = 2),
butterfly3() %>% mutate(id = 3))
library(mathart)
library(mathart)
df <- rbind(heart1() %>% mutate(id = 1),
heart2() %>% mutate(id = 2),
heart3() %>% mutate(id = 3),
heart4() %>% mutate(id = 4))
library("mathart", lib.loc="/Library/Frameworks/R.framework/Versions/3.5/Resources/library")
df <- rbind(heart1() %>% mutate(id = 1),
heart2() %>% mutate(id = 2),
heart3() %>% mutate(id = 3),
heart4() %>% mutate(id = 4))
#install.packages("kableExtra")
library(tidyverse)
#install.packages("kableExtra")
library(tidyverse)
df <- rbind(heart1() %>% mutate(id = 1),
heart2() %>% mutate(id = 2),
heart3() %>% mutate(id = 3),
heart4() %>% mutate(id = 4))
df <- rbind(heart1() %>% mutate(id = 1),
heart2() %>% mutate(id = 2),
heart3() %>% mutate(id = 3),
heart4() %>% mutate(id = 4))
ggplot(notes_psycho) +
geom_boxplot(aes(y = français, x = groupe, color = groupe)) +
labs(title = "Distribution du score en français par groupe et genre")
#install.packages("kableExtra")
library(tidyverse)
library(haven)
library(summarytools)
library(pander)
library(knitr)
library(kableExtra)
# For formatting table
# https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_html.html
notes_psycho <- read_sav("Notes_psycho.sav")
notes_psycho <-
notes_psycho %>%
transmute(groupe = factor(Groupecours, labels = c("Groupe 1", "Groupe 2", "Groupe 3")),
sexe = as_factor(sexe),
français = notefr,
math = Noteps,
moyenne = moysec)
#glimpse(notes_psycho)
# Relation entre type de groupe et résultats scolaire
notes_psycho %>%
group_by(groupe) %>%
summarise('moyenne note math' = mean(math),
'moyenne note français' = mean(français)) %>%
kable(digits = 2, caption = "Tableau 1: Moyenne des notes de PS et de fr par groupe") %>%
kable_styling()
# Est-ce que la composition du groupe affecte la relation entre groupe et résultat
with(notes_psycho, summarytools::ctable(groupe, sexe, "t", report.nas = FALSE)) %>%
kable(digits = 2, caption = "Tableau croisé groupe et sexe") %>%
kable_styling()
# Est-ce que la composition du groupe affecte la relation entre groupe et résultat
ligne <- with(notes_psycho, summarytools::ctable(groupe, sexe, "r", report.nas = FALSE)) %>%
kable(digits = 2, caption = "Tableau croisé groupe et sexe") %>%
kable_styling()
# Est-ce que la composition du groupe affecte la relation entre groupe et résultat
with(notes_psycho, summarytools::ctable(groupe, sexe, "c", report.nas = FALSE)) %>%
kable(digits = 2, caption = "Tableau croisé groupe et sexe") %>%
kable_styling()
# Est-ce que la composition du groupe affecte la relation entre groupe et résultat
ggplot(notes_psycho) +
geom_boxplot(aes(y = français, x = groupe, color = groupe)) +
labs(title = "Distribution du score en français par groupe et genre")
# Est-ce que la composition du groupe affecte la relation entre groupe et résultat
ggplot(notes_psycho) +
geom_boxplot(aes(y = français, x = groupe, color = groupe)) +
labs(title = "Distribution du score en français par groupe et genre") +
facet_wrap(~ sexe)
star <- read_csv("STAR.csv")
star <-
star %>%
mutate(classtype = factor(classtype, labels = c("Petite classe", "Taille moyenne", "Taille moyenne avec aide")))
table_taille_res <-
star %>%
group_by(classtype) %>%
summarise(moyenne_math = mean(g4reading, na.rm = TRUE))
table_taille_res %>%
kable(digits = 2, caption = "Moyenne en math par type de classe") %>%
kable_styling()
# Est-ce que lapetite classe permet de meilleurs résultats plus tard
with(star , ctable(hsgrad, classtype, "c", useNA = "no")) %>%
kable(digits = 2, caption = "Tableau croisé entre taille de la classe et le fait de gradué") %>%
kable_styling()
# Est-ce que la composition du groupe affecte la relation entre groupe et résultat
ligne <- with(notes_psycho, summarytools::ctable(groupe, sexe, "r", report.nas = FALSE)) %>%
kable(digits = 2, caption = "Tableau 2.3: tableau croisé entre groupe et sexe") %>%
kable_styling(latex_options = c("striped", "hold_position"))
# Est-ce que la composition du groupe affecte la relation entre groupe et résultat
with(notes_psycho, summarytools::ctable(groupe, sexe, "r", report.nas = FALSE)) %>%
kable(digits = 2, caption = "Tableau 2.3: tableau croisé entre groupe et sexe") %>%
kable_styling(latex_options = c("striped", "hold_position"))
library(swirl)
uninstall_course("swirl_imqcss")
install_course_github("visseho", "swirl_imqcss")
swirl()
library(swirl)
uninstall_course("swirl_imqcss")
install_course_github("visseho", "swirl_imqcss")
swirl()
8-2
10^2
sqrt(9)
resultat <- 8-2
resultat
cours <- "science sociale"
cours <- "apprendre R"
resultat2 <- resultat
resultat <- 1-2
resultat <- 10-2
world.pop
bye()
